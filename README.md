# PLPPS-pipeline
A comprehensive and rigid computational framework to construct a patient-level personalized prognostic signature
.
> This repository provides the code for the paper "A mechanistically-derived patient-level immune prognostic signature in high-grade serous ovarian cancer".

![PLPPS-pipeline](https://github.com/AlisaGU/PLPPS-pipeline/blob/master/Image/PLPPS_pipeline.png)

##### 1) Screening of mechanistically derived prognostic genes
To acquire comprehensive, precise and explicable prognostic genes, univariate Cox regression analysis was performed to assess prognostic value of each gene in each dataset. Then, meta-analysis was conducted to integrate gene’s HR value from multiple dataset and evaluate their overall impact on prognosis. We assessed the heterogeneity using the Q-test and chose to conduct a random-effects model when P < 0.05, otherwise a fixed-effects model was implemented. Next, multiple testing correction (Benjamini-Hochberg, BH) was performed, and candidate survival-related markers were identified using an adjusted P value threshold of 0.01. Finally, to acquire comprehensive, precise and explicable prognostic biomarkers, functional enrichment analysis for candidate prognostic genes was performed using R package ‘clusterProfiler’. Candidate prognostic genes involved in significantly enriched biological processes were retained as biologically plausible prognostic genes.
##### 2) Construction and validation of a patient-level personalized prognostic signature
To construct a patient-level prognostic signature in a personalized manner without the need to normalize data from various sources, a modified single sample gene set enrichment analysis (ssGSEA) was used to constructed an patient-level personalized prognostic signature (PLPPS) based on gene expression levels of individual samples. The difference of overall survival between subgroups was assessed using Kaplan-Meier estimates and the statistical significance was assessed by log-rank test. Uni- and multi-variate Cox regression analysis was performed to measure the correlation between various factors and overall survival. Hazard ratios (HR) and 95% confidence intervals (CI) were calculated to assess the factor’s impact on prognosis. Comparative analysis of performance from diverse signatures was conducted according to HR and Harrell's concordance index (C-index) statistic.
